<!DOCTYPE html>
<html lang="en" x-permissions="order_invoice_ui || order_invoice_manage" data-ng-app="myApp">

<head x-import="head.html">
    <style>
        .order-invoice {
            padding: 5px;
        }

        .item-groups {
            display: block;
            padding: 10px;
            margin-bottom: 50px;
        }

        .item-groups .item {
            width: 200px;
            height: 150px;
            display: inline-block;
            border: 1px solid #000;
            text-align: center;
            margin: 5px;
        }

        .item-groups .item:hover {
            transform: scale(1.1);
        }

        .item-groups img {
            width: 100%;
            height: 100%;
        }

        .item-groups h2 {
            position: relative;
            background: #0000008f;
            margin-top: -100px;
            color: #ffeb3b;
            text-align: center;
        }

        .item-list {
            display: block;
            padding: 10px;
        }

        .item-list .item {
            width: 200px;
            height: 150px;
            display: inline-block;
            border: 1px solid #0000ff;
            text-align: center;
            margin: 5px;
            border-radius: 20px;
        }

        .item-list .item:hover {
            transform: scale(1.1);
        }

        .item-list img {
            width: 100%;
            height: 100%;
        }

        .item-list h2 {
            position: relative;
            background: #5369e0e6;
            margin-top: -100px;
            color: #ffffff;
            text-align: center;
        }


        .item-types {
            display: block;
            padding: 10px;
            margin-bottom: 50px;
        }

        .item-types .item {
            width: 200px;
            height: 150px;
            display: inline-block;
            border: 1px solid #000;
            text-align: center;
            margin: 5px;
        }

        .item-types .item:hover {
            transform: scale(1.1);
        }

        .item-types img {
            width: 100%;
            height: 100%;
        }

        .item-types h2 {
            position: relative;
            background: #0000008f;
            margin-top: -100px;
            color: #fff;
            text-align: center;
        }

        .code,
        .code input {
            color: blue;
            font-weight: bold;
            font-size: 22px;
        }
        .btn{
            min-width: 200px;
        }
        .btn.saving {
            width: 200px;
            height: 100px;
            font-size: 22px;
            padding-top: 30px;
            background: #118011;
            font-weight: bold;
        }

        .btn.closing {
            width: 200px;
            height: 100px;
            font-size: 22px;
            padding-top: 30px;
            background: #e21212;
            font-weight: bold;
        }

        .btn.new,
        .btn.view {
            width: 150px;
            height: 50px;
            padding-top: 13px;
        }
    </style>
</head>

<body class="##session.lang##">

    <nav x-import="sitebar/index.html" class="sitebar" data-ng-controller="sitebar">

    </nav>

    <nav class="sitebottom" x-import="sitebottom/index.html" ng-controller="sitebottom">

    </nav>

    <div id="main-layout" class="container">
        <div class="row" style="
        margin-bottom: 200px !important;">
            <div class="row" ng-controller="order_invoice">
                <div x-permissions="order_invoice_add || order_invoice_manage"
                    x-import="order-invoice/order_invoices_active.html">
                </div>
                <div x-permissions="order_invoice_add || order_invoice_manage"
                    x-import="order-invoice/delivery_service.html">
                </div>
                <div x-permissions="order_invoice_add || order_invoice_manage"
                    x-import="order-invoice/select_table.html">
                </div>
                <div x-permissions="order_invoice_add || order_invoice_manage"
                    x-import="order-invoice/merge_tables.html">
                </div>
                <!--  <div x-permissions="order_invoice_add || order_invoice_manage"
                    x-import="order-invoice/change_item_count.html">
                </div> -->
                <div x-permissions="order_invoice_update || order_invoice_manage"
                    x-import="order-invoice/update_modal.html"></div>
                <div x-permissions="order_invoice_delete || order_invoice_manage"
                    x-import="order-invoice/delete_modal.html"></div>
                <div x-permissions="order_invoice_view || order_invoice_manage"
                    x-import="order-invoice/view_modal.html"></div>
                <div x-import="order-invoice/items_modal.html"></div>
                <div x-permissions="order_invoice_search || order_invoice_manage"
                    x-import="order-invoice/search_all_modal.html"></div>

                <div class="row">

                    <div class="col6">
                        <div class="item-groups">
                            <a class="item pointer " ng-repeat="g in itemsGroupList" ng-click="loadItems(g)"
                                help-id="menu_monitor">
                                <img ng-src="{{g.image_url}}">
                                <h2>{{g.name}}</h2>
                            </a>
                        </div>

                        <div class="item-list" ng-show="itemsList.length > 0">
                            <a class="item pointer" ng-repeat="i in itemsList" ng-click="showItemsIn(i)"
                                help-id="menu_monitor">
                                <img ng-src="{{i.image_url}}">
                                <h2>{{i.name}}</h2>
                            </a>
                        </div>

                        <br>

                        <div class="item-types">
                            <a class="item pointer" ng-repeat="s in current_items.sizes" ng-click="bookList(s)"
                                help-id="menu_monitor">
                                <img ng-src="{{s.image_url}}" onerror="this.src='/images/no.png'">
                                <h2>{{s.size}}</h2>
                            </a>

                        </div>
                    </div>

                    <div class="col6 order-invoice">
                        <h2 class="bold center red">{{error}}</h2>
                        <div class="row">
                            <div class="row">
                                <i-button type="bg-green" label="##word.new_order##" ng-click="newOrderInvoice()">
                                </i-button>
                                <i-button type="bg-blue" label="##word.open_orders##" ng-click="viewInvoicesActiveList()">
                                </i-button>
                                <i-button class="hidden" type="bg-red" label="##word.cancel_order##" ng-click="cancelOrderInvoice()">
                                </i-button>
                            </div>
                            <i-control class="col3 code" disabled label="##word.code##" ng-model="order_invoice.code">
                            </i-control>
                            <i-date2 class="col6" ng-model="order_invoice.date" label="##word.date##"></i-date2>
                        </div>

                        <div class="row">
                            <i-list ng-search="_search.$transaction_type" class="col4" display="##session.lang##"
                                ng-model="order_invoice.transaction_type" label="##word.transaction_type##"
                                items="transactionTypeList" ng-change="calc()">
                            </i-list>

                            <i-button ng-show="order_invoice.transaction_type.id == 1 && order_invoice.id" type="bg-blue"
                                label="##word.merge_table##" ng-click="viewInvoicesTablesList()">
                            </i-button>
                            <i-list ng-show="order_invoice.transaction_type.id == 2"
                                ng-search="_search.$order_invoice_employee" class="col4" display="name"
                                ng-model="order_invoice.delivery_employee" label="##word.delivery_employee##"
                                items="deliveryEmployeesList"></i-list>

                            <div class="row" ng-show="order_invoice.transaction_type.id == 1">
                                <i-button type="bg-blue" label="##word.select_table##" ng-click="showTable()">
                                </i-button>
                                <i-control class="col4" ng-model="order_invoice.table.name" label="##word.table##"
                                    type="text" disabled></i-control>
                                <i-control class="col2" ng-model="order_invoice.count_person"
                                    label="##word.count_person##" type="number"></i-control>
                                <i-control class="col2" ng-model="order_invoice.service" label="##word.service##"
                                    type="number" ng-change="calc()"></i-control>
                            </div>
                        </div>

                        <fieldset ng-show="order_invoice.transaction_type.id == 2">
                            <legend> ##word.customer_data##</legend>
                            <div class="row">

                                <div class="row">

                                    <i-list ng-search="_search.$order_customers" class="col3" display="name_ar"
                                        ng-model="order_invoice.customer" label="##word.customer_name##"
                                        ng-change="changeCustomerAddresses(order_invoice.customer)"
                                        items="customersList">
                                    </i-list>

                                    <i-list class="col3" label="##word.customers_gov##" ng-model="order_invoice.gov"
                                        items="govList" display="name" ng-change="getCityList(order_invoice.gov)"
                                        ng-search="_search.$govNameContact"></i-list>

                                    <i-list class="col3" label="##word.city##" ng-model="order_invoice.city"
                                        items="cityList" ng-change="getAreaList(order_invoice.city)" display="name"
                                        ng-search="_search.$order_invoice_city_search"></i-list>

                                    <i-list class="col3" label="##word.area##" ng-model="order_invoice.area"
                                        items="areaList" display="name"
                                        ng-change=" order_invoice.price_delivery_service = order_invoice.area.price_delivery_service"
                                        ng-search="_search.$order_invoice.$area_search"></i-list>

                                </div>

                                <div class="row">

                                    <i-control ng-show="order_invoice.transaction_type.id == 2"
                                        ng-model="order_invoice.price_delivery_service"
                                        label="##word.price_delivery_service##" ng-change="calc()" class="col3"
                                        type="number"></i-control>

                                    <i-control class="col6" label="##word.customers_address##"
                                        ng-model="order_invoice.address"></i-control>

                                    <i-control class="col3" label="##word.customers_mobile##"
                                        ng-model="order_invoice.customer_mobile">
                                    </i-control>

                                </div>

                            </div>
                        </fieldset>

                        <div class="row ">

                            <table x-permissions="login" class="table bold loaded" id="t1">

                                <tr>
                                    <th>##word.stores_items_name##</th>
                                    <th>##word.items_count##</th>
                                    <th>##word.items_price##</th>
                                    <th>##word.items_price_total##</th>
                                    <th>##word.notes##</th>
                                    <th class="not-print">##word.actions##</th>
                                </tr>

                                <tr ng-repeat="c in order_invoice.book_list">
                                    <td class="center title">{{c.size}}</td>
                                    <td class="center w200 ">
                                        <i-control ng-change="calc()" ng-model="c.count" type="number">
                                        </i-control>
                                    </td>
                                    <td class="center blue">{{c.price}}</td>
                                    <td class="center green">{{c.total_price}}</td>
                                    <td class="center">
                                        <i-control ng-model="c.notes"></i-control>
                                    </td>
                                    <td class="center not-print">
                                        <i-button type="delete" label="##word.delete##"
                                            ng-click="deleteItemsList(c) ; calc()"></i-button>
                                    </td>
                                </tr>

                            </table>
                        </div>

                        <div class="row">

                            <div class="col6 padding margin">
                                <table class="table box-shadow " ng-init="discountEditorAdd = true">
                                    <tr>
                                        <th colspan="2" class="pointer"
                                            ng-click="discountEditorAdd = !discountEditorAdd">
                                            ##word.stores_out_discountes##
                                            <i class="fa fa-edit"></i>
                                        </th>
                                    </tr>
                                    <tr ng-hide="discountEditorAdd">
                                        <td colspan="2">
                                            <form>

                                                <div class="row ">
                                                    <i-list class="col4" ng-model="discount"
                                                        ng-search="_search.$discount_name" items="discount_types"
                                                        label="##word.stores_out_discount_name##">
                                                    </i-list>
                                                </div>

                                                <div class="row">
                                                    <i-control class="col4" ng-model="discount.value"
                                                        label="##word.stores_out_discount_value##"></i-control>
                                                    <div class="col5 padding">
                                                        <br>
                                                        <i-button ng-click="addDiscount() ;calc()"
                                                            label="##word.stores_out_add_discount##" type="add default">
                                                        </i-button>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <i-radio class="col5" ng-model="discount.type" ng-value="number"
                                                        group="type" label="##word.discount_types_number##"></i-radio>

                                                    <i-radio class="col5" ng-model="discount.type" group="type"
                                                        ng-value="percent" label="##word.discount_types_percent##">
                                                    </i-radio>
                                                </div>
                                            </form>
                                        </td>
                                    </tr>

                                    <tr ng-repeat="d1 in order_invoice.discountes">

                                        <td>
                                            <span class="bold red">{{d1.name}} -</span>
                                            <span class="bold red" ng-show="d1.type === 'percent'">{{d1.value}} %</span>
                                            <span class="bold red"
                                                ng-show="d1.type === 'number'">{{d1.value}}##word.le##</span>
                                            <i-button type="delete" ng-click="deleteDiscount(d1) ; calc()"> </i-button>
                                        </td>

                                    </tr>
                                </table>

                            </div>

                            <div class="col5 padding margin">
                                <table class="table box-shadow " ng-init="taxEditorAdd = true">

                                    <tr>
                                        <th colspan="2" class="pointer" ng-click="taxEditorAdd = !taxEditorAdd">
                                            ##word.stores_out_taxes##
                                            <i class="fa fa-edit"></i>
                                        </th>
                                    </tr>

                                    <tr ng-hide="taxEditorAdd">
                                        <td colspan="2">
                                            <div class="row">
                                                <i-list class="col6" ng-model="tax"
                                                    label="##word.stores_out_discount_name##"
                                                    ng-search="_search.$taxtypes" items="tax_types"></i-list>
                                            </div>
                                            <div class="row">
                                                <i-control class="col4" ng-model="tax.value"
                                                    label="##word.stores_out_discount_value##">
                                                </i-control>
                                                <div class="col5 padding">
                                                    <br>
                                                    <i-button type="add default" label="##word.stores_out_add_tax##"
                                                        ng-click="addTax() ;calc()">
                                                    </i-button>

                                                </div>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr ng-repeat="tx in order_invoice.taxes">
                                        <td>
                                            <span class="bold red">{{tx.name}} -</span>
                                            <span class="bold red">{{tx.value}} %</span>
                                            <i-button type="delete" ng-click="deleteTax(tx) ;calc()"> </i-button>
                                        </td>
                                    </tr>
                                </table>

                            </div>

                        </div>

                        <div class="row">
                            <i-control class="col3" ng-model="order_invoice.total_discount"
                                label="##word.stores_out_total_discount##" type="number" disabled></i-control>
                            <i-control class="col3" ng-model="order_invoice.total_tax"
                                label="##word.stores_out_total_tax##" type="number" disabled></i-control>
                            <i-control class="col3" ng-model="order_invoice.total_value" label="##word.total_value##"
                                type="number" disabled></i-control>

                        </div>
                        <h2 class="bold center red">{{error}}</h2>

                        <div class="row">
                            <i-control class="col6" ng-model="order_invoice.net_value" label="##word.net_value##"
                                type="number" disabled></i-control>
                            <div class="col6 center" ng-hide="order_invoice.status.id == 2">
                                <i-button type="saving" label="##word.save##" ng-click="addOrderInvoice()">
                                </i-button>
                                <br>
                                <br>
                                <br>
                                <i-button type="closing" ng-hide="order_invoice.active == false"
                                    label="##word.close_order##" ng-click="closeOrder()">
                                </i-button>
                            </div>

                        </div>

                       

                    </div>
                </div>

            </div>
            <div class="top-actions">

            </div>

        </div>
    </div>

    <div x-import="scripts.html"></div>
    <script x-import="order-invoice/index.js"></script>
</body>

</html>